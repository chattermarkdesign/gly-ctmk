function horizontalLoop(e,t){let r;return e=gsap.utils.toArray(e),t=t||{},gsap.context(()=>{let o,n,a,i=t.onChange,s=0,l=gsap.timeline({repeat:t.repeat,onUpdate:i&&function(){let t=l.closestIndex();s!==t&&(s=t,i(e[t],t))},paused:t.paused,defaults:{ease:"none"},onReverseComplete:()=>l.totalTime(l.rawTime()+100*l.duration())}),d=e.length,c=e[0].offsetLeft,g=[],p=[],u=[],m=[],h=0,f=!1,w=t.center,v=100*(t.speed||1),y=!1===t.snap?e=>e:gsap.utils.snap(t.snap||1),x=0,b=!0===w?e[0].parentNode:gsap.utils.toArray(w)[0]||e[0].parentNode,S=()=>{let r,n=b.getBoundingClientRect();e.forEach((e,t)=>{p[t]=parseFloat(gsap.getProperty(e,"width","px")),m[t]=y(parseFloat(gsap.getProperty(e,"x","px"))/p[t]*100+gsap.getProperty(e,"xPercent")),r=e.getBoundingClientRect(),u[t]=r.left-(t?n.right:n.left),n=r}),gsap.set(e,{xPercent:e=>m[e]}),o=e[d-1].offsetLeft+m[d-1]/100*p[d-1]-c+u[0]+e[d-1].offsetWidth*gsap.getProperty(e[d-1],"scaleX")+(parseFloat(t.paddingRight)||0)},T=()=>{x=w?l.duration()*(b.offsetWidth/2)/o:0,w&&g.forEach((e,t)=>{g[t]=n(l.labels["label"+t]+l.duration()*p[t]/2/o-x)})},P=(e,t,r)=>{let o,n=e.length,a=1e10,i=0;for(;n--;)o=Math.abs(e[n]-t),o>r/2&&(o=r-o),o<a&&(a=o,i=n);return i},L=()=>{let t,r,a,i,s;for(l.clear(),t=0;t<d;t++)r=e[t],a=m[t]/100*p[t],i=r.offsetLeft+a-c+u[0],s=i+p[t]*gsap.getProperty(r,"scaleX"),l.to(r,{xPercent:y((a-s)/p[t]*100),duration:s/v},0).fromTo(r,{xPercent:y((a-s+o)/p[t]*100)},{xPercent:m[t],duration:(a-s+o-a)/v,immediateRender:!1},s/v).add("label"+t,i/v),g[t]=i/v;n=gsap.utils.wrap(0,l.duration())},E=e=>{let t=l.progress();l.progress(0,!0),S(),e&&L(),T(),e&&l.draggable&&l.paused()?l.time(g[h],!0):l.progress(t,!0)},I=()=>E(!0);function k(e,t){t=t||{},Math.abs(e-h)>d/2&&(e+=e>h?-d:d);let r=gsap.utils.wrap(0,d,e),o=g[r];return o>l.time()!=e>h&&e!==h&&(o+=l.duration()*(e>h?1:-1)),(o<0||o>l.duration())&&(t.modifiers={time:n}),h=r,t.overwrite=!0,gsap.killTweensOf(a),0===t.duration?l.time(n(o)):l.tweenTo(o,t)}if(gsap.set(e,{x:0}),S(),L(),T(),window.addEventListener("resize",I),l.toIndex=(e,t)=>k(e,t),l.closestIndex=e=>{let t=P(g,l.time(),l.duration());return e&&(h=t,f=!1),t},l.current=()=>f?l.closestIndex(!0):h,l.next=e=>k(l.current()+1,e),l.previous=e=>k(l.current()-1,e),l.times=g,l.progress(1,!0).progress(0,!0),t.reversed&&(l.vars.onReverseComplete(),l.reverse()),t.draggable&&"function"==typeof Draggable){a=document.createElement("div");let t,r,i,s,d,c,p=gsap.utils.wrap(0,1),u=()=>l.progress(p(r+(i.startX-i.x)*t)),m=()=>l.closestIndex(!0);"undefined"==typeof InertiaPlugin&&console.warn("InertiaPlugin required for momentum-based scrolling and snapping. https://greensock.com/club"),i=Draggable.create(a,{trigger:e[0].parentNode,type:"x",onPressInit(){let e=this.x;gsap.killTweensOf(l),c=!l.paused(),l.pause(),r=l.progress(),E(),t=1/o,d=r/-t-e,gsap.set(a,{x:r/-t})},onDrag:u,onThrowUpdate:u,overshootTolerance:0,inertia:!0,snap(e){if(Math.abs(r/-t-this.x)<10)return s+d;let o=-e*t*l.duration(),a=n(o),i=g[P(g,a,l.duration())]-a;return Math.abs(i)>l.duration()/2&&(i+=i<0?l.duration():-l.duration()),s=(o+i)/l.duration()/-t,s},onRelease(){m(),i.isThrowing&&(f=!0)},onThrowComplete:()=>{m(),c&&l.play()}})[0],l.draggable=i}return l.closestIndex(!0),s=h,i&&i(e[h],h),r=l,()=>window.removeEventListener("resize",I)}),r}const sliderParams={duration:.5,ease:"power2.out"};addEventListener("GSAPReady",e=>{document.querySelectorAll("[data-animate='slider']").forEach(e=>{const t=[...e.querySelector("[data-slider='slides']").children],r=e.querySelector("[data-slider='progress']"),o=e.querySelector("[data-slider='next']"),n=e.querySelector("[data-slider='prev']");let a=0;let i;setTimeout(()=>{i=horizontalLoop(t,{paused:!0,draggable:!0,center:!0,onChange:(e,o)=>{(e=>{t[a].classList.remove("current"),t[e].classList.add("current"),gsap.to(r.children[0],{width:e/(t.length-1)*100+"%",duration:.6,ease:"expo.out"}),a=e})(o)}})},500),o.addEventListener("click",()=>{i.next(sliderParams)}),n.addEventListener("click",()=>{i.previous(sliderParams)})})});{let e;const t=()=>{e=new Lenis({}),e.on("scroll",ScrollTrigger.update),gsap.ticker.add(t=>e.raf(1e3*t)),gsap.ticker.lagSmoothing(0)};function initGsapGlobal(){t();const r=()=>{window.dispatchEvent(new CustomEvent("GSAPReady",{detail:{lenis:e}}))};let o;"loaded"===document.fonts.status?r():document.fonts.ready.then(()=>{r()});const n=()=>{clearTimeout(o),o=setTimeout(()=>{ScrollTrigger.refresh()},50)};window.addEventListener("resize",()=>n());new ResizeObserver(e=>n()).observe(document.body),queueMicrotask(()=>{gsap.to("[data-start='hidden']",{autoAlpha:1,duration:.1,delay:.2})})}"complete"===document.readyState||"interactive"===document.readyState?initGsapGlobal():addEventListener("DOMContentLoaded",e=>initGsapGlobal())}document.addEventListener("DOMContentLoaded",e=>{gsap.registerPlugin(ScrollTrigger,Draggable,InertiaPlugin,ScrambleTextPlugin,SplitText),gsap.matchMedia().add({isDesktop:"(min-width: 768px) and (prefers-reduced-motion: no-preference)",isMobile:"(max-width: 767px) and (prefers-reduced-motion: no-preference)"},e=>{let{isMobile:t,isDesktop:r}=e.conditions;document.querySelectorAll('[animation-container="text-fade-in"]').forEach(e=>{e.querySelectorAll('[animation-element="text-fade-in"]').forEach(e=>{const t=new SplitText(e,{type:"words,chars"}),r=1/t.chars.length;gsap.fromTo(t.chars,{opacity:.1},{opacity:1,ease:"none",stagger:r,duration:1,scrollTrigger:{trigger:e,start:"top 90%",end:"top 20%",once:!0}})})});const o=document.querySelector(".vision_overlay-text"),n=new SplitText(o,{type:"words,chars"}).chars;gsap.set(n,{opacity:0}),gsap.set(".vision_image-wrapper.is-image-large",{width:t?"50vw":"36vw",height:t?"60vh":"80vh"});gsap.timeline({scrollTrigger:{trigger:".vision_content-bottom",start:"top top",end:"bottom 60%",scrub:.5,pin:!0,pinSpacing:!0,anticipatePin:1,markers:!1}}).to(".vision_image-wrapper.is-image-large",{width:"100vw",height:"100vh",borderRadius:"0px",x:t?"-25vw":"-32vw",ease:"power2.inOut"},0).to(".vision_image-group-left",{x:t?"-25vw":"-32vw",ease:"power2.inOut"},0).to(".vision_image-group-right",{x:t?"25vw":"32vw",ease:"power2.inOut"},0),gsap.timeline({scrollTrigger:{trigger:".vision_content-bottom",start:"center 48%",end:"bottom bottom",toggleActions:"play none reverse none",markers:!1}}).to(n,{opacity:1,duration:1.5,stagger:{each:1/n.length,from:"random"},ease:"power2.out"}),window.addEventListener("resize",()=>{ScrollTrigger.refresh()})})}),document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".custom-slider");e.forEach(e=>{const t=e.querySelector(".w-slider-arrow-right"),r=e.querySelector(".progressfill");function o(){r.style.transition="none",r.style.width="0%",requestAnimationFrame(()=>{requestAnimationFrame(()=>{r.style.transition="width 2000ms linear",r.style.width="100%"})})}t&&r?(o(),setInterval(function(){t.click(),o()},2e3)):console.warn("Slider incomplet : bouton ou barre manquante.")})}),$(document).ready(function(){var e=$("#MultiImageSlider"),t=e.find(".w-slide"),r=$("#MultiImageCollectionWrapper"),o=r.find(".w-dyn-item");if(e.length&&r.length){if(e.css("opacity",0),o.length){var n=o.length,a=t.length;n>a&&(n=a);for(var i=0;i<n;i++){const e=$(o[i]),r=$(t[i]);if(!r||!e)continue;const n=window.getComputedStyle(e.find(".cms-image")[0])?.backgroundImage,a=e.find(".cms-title").html(),s=e.find(".cms-richtext").html();n&&"none"!==n&&r.css("background-image",n),r.find(".slide-title").html(a||""),r.find(".slide-richtext").html(s||"")}for(i=a-1;i>=n;i--)$(t[i]).remove();n<2&&e.find(".w-slider-arrow-left, .w-slider-arrow-right, .w-slider-nav").remove(),e.css("opacity",1)}else e.remove();r.remove()}}),$(document).ready(function(){var e=$("#MultiImageSlider"),t=e.find(".w-slide"),r=$("#MultiImageCollectionWrapper"),o=r.find(".w-dyn-item");if(console.log("Slider:",e),console.log("Slides trouvés:",t.length),console.log("Images CMS trouvées:",o.length),e.length&&r.length){if(e.css("opacity",0),o.length){var n=o.length,a=t.length;n>a&&(n=a);for(var i=0;i<n;i++)t[i].style.backgroundImage=o[i].style.backgroundImage;for(i=a;i>n;i--)t[i-1].remove();n<2&&e.find(".w-slider-arrow-left, .w-slider-arrow-right, .w-slider-nav").remove(),e.css("opacity",1)}else e.remove();r.remove()}});